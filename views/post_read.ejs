<!DOCTYPE html>
<html>
  <%- include("./partials/head"); %>
  <body>
    <%- include("./partials/header"); %>
    <main>
        <h1> <%= title %> </h1>

        <div class="testPost">
          <h2><%= post.title %></h2>
          <p><%= post.author.full_name %></p>
          <p><%= post.timestamp %></p>
          <p><%= post.body %></p>
        </div>

        <% if (localStorage.length > 0) { %>
          <form action="" method="POST">
            <label for="commentBody">Comment</label>
            <textarea 
              name="commentBody" 
              type="text" 
              maxlength="500" 
              rows="10" 
              placeholder="Max 500 characters" 
              req uired>
            </textarea>
            <button>Submit</button>
          </form>
        <% } else { %>
          <p> Sign in to add a comment. </p>
        <% } %>
    
        <% if (comments.length > 0) { %>
          <ul>
            <% comments.forEach((comment) => { %>
              <li class="testPost">
                <p><%= comment.reader.full_name %></p>
                <p><%= comment.timestamp %></p>
                <p><%= comment.body %></p>
                <p><%= comment.reader._id %></p>
                
                <% if ( comment.reader._id == localStorage.getItem('id') ) { %>
                  <button>Delete</button>
                <% } %> 

              </li>
            <% }) %> 
          </ul>
        <% } else { %>
          <p>There are no comments on this post yet.</p>
        <% } %>
    </main>
    <%- include("./partials/footer"); %>
  </body>
</html>
